import torch

# 加法运算
x = torch.rand(5, 3)
y = torch.rand(5, 3)
print(x)
# tensor([[0.2695, 0.1423, 0.2469],
#         [0.9859, 0.1606, 0.5971],
#         [0.6068, 0.1189, 0.0268],
#         [0.0796, 0.6299, 0.4329],
#         [0.7962, 0.3573, 0.1901]])
print(y)
# tensor([[0.7360, 0.3899, 0.2385],
#         [0.0475, 0.4271, 0.6104],
#         [0.6282, 0.6575, 0.6903],
#         [0.3584, 0.3825, 0.2884],
#         [0.4325, 0.9850, 0.9825]])
# first solution
print(x + y)
# second solution
print(torch.add(x, y))
# third solution
result = torch.empty(5, 3)
torch.add(x, y, out = result)
print(result)
# forth solution
y.add_(x)
print(y)
# tensor([[1.0056, 0.5322, 0.4854],
#         [1.0334, 0.5877, 1.2075],
#         [1.2350, 0.7764, 0.7171],
#         [0.4380, 1.0124, 0.7213],
#         [1.2287, 1.3422, 1.1726]])
# 切片
print(x[:, 1])
# tensor([0.1423, 0.1606, 0.1189, 0.6299, 0.3573])
# 改变形状
a = torch.rand(4, 4)
b = a.view(16)
c = a.view(-1, 8)
print(a)
# tensor([[0.0832, 0.3872, 0.3075, 0.5746],
#         [0.2557, 0.1186, 0.7007, 0.6512],
#         [0.7204, 0.7749, 0.8682, 0.3087],
#         [0.5084, 0.9872, 0.1075, 0.1955]])
print(b)
# tensor([0.0832, 0.3872, 0.3075, 0.5746, 0.2557, 0.1186, 0.7007, 0.6512, 0.7204,
#         0.7749, 0.8682, 0.3087, 0.5084, 0.9872, 0.1075, 0.1955])
print(c)
# tensor([[0.0832, 0.3872, 0.3075, 0.5746, 0.2557, 0.1186, 0.7007, 0.6512],
#         [0.7204, 0.7749, 0.8682, 0.3087, 0.5084, 0.9872, 0.1075, 0.1955]])